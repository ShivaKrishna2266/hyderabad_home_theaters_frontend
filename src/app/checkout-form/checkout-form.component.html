<div class="container-fluid page-header py-5"></div>

<div class="container-fluid py-5">
  <div class="container py-5">
    <h1 class="mb-4">Billing details</h1>
    <div class="container d-flex justify-content-center align-items-center py-2">
      <div *ngIf=" userName; else loginTemplate" class="text-muted">
         <p><strong>Logged in as : </strong>{{ userName }}</p>
      </div>
      <div *ngIf="profile">
        <p><strong>Email:</strong> {{ profile.email }}</p>
      </div>
      <ng-template #loginTemplate>
        <button class="btn btn-outline-primary btn-sm" (click)="login()">Login</button>
      </ng-template>
    </div>

    <form action="#">
      <div class="row g-5">
        <!-- Left Column - Billing Details -->
        <div class="col-md-6 col-lg-6 col-xl-7">
          <div class="card p-3">
            <div class="row">
              <div class="col-md-6 col-lg-6">
                <div class="form-item w-100">
                  <label class="form-label my-3">First Name<sup>*</sup></label>
                  <input type="text" class="form-control" required>
                </div>
              </div>
              <div class="col-md-6 col-lg-6">
                <div class="form-item w-100">
                  <label class="form-label my-3">Last Name<sup>*</sup></label>
                  <input type="text" class="form-control" required>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="form-item col-md-6 col-sm-6 col-lg-6">
                <label class="form-label my-3">Mobile<sup>*</sup></label>
                <input type="tel" class="form-control" required>
              </div>

              <div class="form-item col-md-6 col-sm-6 col-lg-6">
                <label class="form-label my-3">Email Address<sup>*</sup></label>
                <input type="email" class="form-control" required>
              </div>
            </div>

            <div class="form-item">
              <label class="form-label my-3">Company Name<sup>*</sup></label>
              <input type="text" class="form-control">
            </div>

            <div class="form-item">
              <label class="form-label my-3">Address<sup>*</sup></label>
              <input type="text" class="form-control" placeholder="House Number, Street Name" required>
            </div>

            <div class="row">
              <div class="form-item col-md-4 col-lg-4 col-sm-4">
                <label class="form-label my-3">Town/City<sup>*</sup></label>
                <input type="text" class="form-control" required>
              </div>

              <div class="form-item col-md-4 col-lg-4 col-sm-4">
                <label class="form-label my-3">Country<sup>*</sup></label>
                <input type="text" class="form-control" required>
              </div>

              <div class="form-item col-md-4 col-lg-4 col-sm-4">
                <label class="form-label my-3">Postcode/Zip<sup>*</sup></label>
                <input type="text" class="form-control" required>
              </div>
            </div>

            <div class="form-check my-3">
              <input type="checkbox" class="form-check-input" id="Account-1" name="createAccount">
              <label class="form-check-label" for="Account-1">Create an account?</label>
            </div>

            <hr>

            <div class="form-check my-3">
              <input type="checkbox" class="form-check-input" id="Address-1" name="differentAddress">
              <label class="form-check-label" for="Address-1">Ship to a different address?</label>
            </div>

            <div class="form-item">
              <textarea name="orderNotes" class="form-control" rows="5" placeholder="Order Notes (Optional)"></textarea>
            </div>
          </div>

          <div class="card p-3 mt-4">
            <h5 class="mb-3">Payment Method</h5>

            <div class="form-check text-start">
              <input type="radio" class="form-check-input" id="paymentRazorpay" name="paymentMethod"
                [(ngModel)]="selectedPaymentMethod" value="razorpay">
              <label class="form-check-label" for="paymentRazorpay">
                <i class="fas fa-credit-card text-primary me-1"></i> Razorpay Secure (UPI, Cards, Wallets, NetBanking)
                <div class="text-muted small ps-4">
                  After clicking “Place Order”, you'll be redirected to Razorpay to complete your purchase securely.
                </div>
              </label>
            </div>

            <div class="form-check text-start mt-3">
              <input type="radio" class="form-check-input" id="paymentBank" name="paymentMethod"
                [(ngModel)]="selectedPaymentMethod" value="bank">
              <label class="form-check-label" for="paymentBank">
                <i class="fas fa-university text-success me-1"></i> Bank Deposit
              </label>
            </div>

            <div class="form-check text-start mt-3">
              <input type="radio" class="form-check-input" id="paymentCOD" name="paymentMethod"
                [(ngModel)]="selectedPaymentMethod" value="cod">
              <label class="form-check-label" for="paymentCOD">
                <i class="fas fa-money-bill-wave text-warning me-1"></i> Cash on Delivery (COD)
              </label>
            </div>

            <!-- Razorpay UPI Input -->
            <div *ngIf="selectedPaymentMethod === 'razorpay'" class="mt-4">
              <label class="form-label">Enter UPI ID:</label>
              <input type="text" class="form-control" [(ngModel)]="upiId" placeholder="example@upi">
              <small class="text-muted">We'll request payment via your UPI app.</small>
            </div>

            <!-- Bank Deposit Info -->
            <div *ngIf="selectedPaymentMethod === 'bank'" class="mt-4">
              <p>Select your bank to deposit the amount:</p>
              <div class="d-flex flex-wrap gap-3">
                <div class="text-center">
                  <img
                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/SBI-logo.svg/120px-SBI-logo.svg.png"
                    width="60">
                  <div>SBI</div>
                </div>
                <div class="text-center">
                  <img
                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/HDFC_Bank_Logo.svg/120px-HDFC_Bank_Logo.svg.png"
                    width="60">
                  <div>HDFC</div>
                </div>
                <div class="text-center">
                  <img
                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/ICICI_Bank_Logo.svg/120px-ICICI_Bank_Logo.svg.png"
                    width="60">
                  <div>ICICI</div>
                </div>
              </div>

              <div class="mt-3">
                <label class="form-label">Reference/Transaction ID</label>
                <input type="text" class="form-control" [(ngModel)]="bankReferenceId"
                  placeholder="If already deposited">
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column - Order Summary -->
        <div class="col-md-6 col-lg-6 col-xl-5">
          <div class="card p-3">
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Products</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let item of cartItems">
                    <tr>
                      <td>
                        <img
                          src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=M3w0NzEyNjZ8MHwxfHNlYXJjaHw0fHxIZWFkcGhvbmVzfGVufDB8MHx8fDE3Mjk1MDkzMjV8MA&amp;ixlib=rb-4.0.3&amp;q=80&amp;w=1080"
                          class="img-fluid rounded-circle" style="width: 90px; height: 90px;" alt="">
                      </td>
                      <td class="py-5">{{ item.product.productName }}</td>
                      <td class="py-5">{{ item.product.productPrice }}</td>
                      <td class="py-5">{{ item.quantity }}</td>
                      <td class="py-5">{{ item.product.productPrice * item.quantity }}</td>
                    </tr>
                  </ng-container>

                  <tr>
                    <td></td>
                    <td class="py-5">Shipping</td>
                    <td colspan="3" class="py-5">
                      <div class="form-check text-start">
                        <input type="radio" class="form-check-input bg-primary border-0" id="Shipping-1"
                          name="shippingOption" value="Free">
                        <label class="form-check-label" for="Shipping-1">Free Shipping</label>
                      </div>
                      <div class="form-check text-start">
                        <input type="radio" class="form-check-input bg-primary border-0" id="Shipping-2"
                          name="shippingOption" value="Flat">
                        <label class="form-check-label" for="Shipping-2">Flat rate: ₹0.00</label>
                      </div>
                      <div class="form-check text-start">
                        <input type="radio" class="form-check-input bg-primary border-0" id="Shipping-3"
                          name="shippingOption" value="Pickup">
                        <label class="form-check-label" for="Shipping-3">Local Pickup: ₹0.00</label>
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td></td>
                    <td class="py-5 text-uppercase">Total Amount:</td>
                    <td colspan="2"></td>
                    <td class="py-5">
                      <div class="total">
                        <h4>₹{{ totalAmount }}</h4>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="row g-4 text-center align-items-center justify-content-center pt-4">
            <button type="button" class="btn border-secondary py-3 px-4 text-uppercase w-100 text-primary"
              (click)="initiatePayment()">
              Place Order
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>